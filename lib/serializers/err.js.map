{"version":3,"sources":["../../src/serializers/err.js"],"names":[],"mappings":"2HAAA;AACA,qE;;AAEO,IAAI,YAAY,GAAG,gBAAe,EAAC,KAAD,EAAf,EAAwB;AAChD,MAAI;AACF,IAAA,GADE;AAEA,EAAA,KAFJ;;AAIA,MAAI,CAAC,yBAAE,OAAF,CAAU,GAAV,CAAL,EAAqB;AACnB,WAAO,KAAP;AACD;;AAED,MAAI,KAAJ;AACA,MAAI;AACF,IAAA,KAAK,GAAG,MAAM,sBAAW,SAAX,CAAqB,GAArB,CAAd;AACD,GAFD,CAEE,OAAO,eAAP,EAAwB;AACxB,QAAI;AACF,MAAA,KAAK,GAAG,MAAM,sBAAW,SAAX,CAAqB,GAArB,EAA0B;AACtC,QAAA,OAAO,EAAE,IAD6B,EAA1B,CAAd;;AAGD,KAJD,CAIE,OAAO,gBAAP,EAAyB;AACzB;AACA,MAAA,OAAO,CAAC,KAAR,CAAc,gBAAd;AACD;AACD;AACA,IAAA,OAAO,CAAC,KAAR,CAAc,eAAd;AACD;;AAED,EAAA,KAAK,CAAC,GAAN,GAAY;AACV,IAAA,IAAI,EAAE,GAAG,CAAC,IADA;AAEV,IAAA,OAAO,EAAE,GAAG,CAAC,OAFH;AAGV,IAAA,KAHU;;AAKV;AACA,IAAA,QAAQ,EAAE,GAAG,CAAC,QANJ,EAAZ;;;AASA,MAAI,QAAQ,GAAG,GAAG,CAAC,QAAJ,GAAe,WAAf,GAA6B,EAA5C;AACA,MAAI,SAAS,GAAG,GAAG,CAAC,SAAJ,GAAgB,eAAhB,GAAkC,EAAlD;AACA,EAAA,KAAK,CAAC,GAAN,GAAY,KAAK,CAAC,GAAN;AACT,KAAE,QAAS,GAAE,SAAU,GAAE,GAAG,CAAC,IAAK,KAAI,GAAG,CAAC,OAAQ,EADrD;;AAGA,SAAO,KAAP;AACD,CAxCM,C","file":"err.js","sourcesContent":["import _ from 'lodash-firecloud';\nimport stacktrace from 'stacktrace-js';\n\nexport let serializeErr = async function({entry}) {\n  let {\n    err\n  } = entry;\n\n  if (!_.isError(err)) {\n    return entry;\n  }\n\n  let stack;\n  try {\n    stack = await stacktrace.fromError(err);\n  } catch (stacktraceError) {\n    try {\n      stack = await stacktrace.fromError(err, {\n        offline: true\n      });\n    } catch (stacktraceError2) {\n      // eslint-disable-next-line no-console\n      console.error(stacktraceError2);\n    }\n    // eslint-disable-next-line no-console\n    console.error(stacktraceError);\n  }\n\n  entry.err = {\n    name: err.name,\n    message: err.message,\n    stack,\n\n    // custom\n    uncaught: err.uncaught\n  };\n\n  let uncaught = err.uncaught ? 'Uncaught ' : '';\n  let inPromise = err.inPromise ? '(in promise) ' : '';\n  entry.msg = entry.msg ||\n    `${uncaught}${inPromise}${err.name}: ${err.message}`;\n\n  return entry;\n};\n\nexport default serializeErr;\n"]}