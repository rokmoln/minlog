{"version":3,"sources":["../../src/serializers/err.js"],"names":[],"mappings":"2HAAA,2E;;AAEO,IAAI,YAAY,GAAG,gBAAe,EAAC,KAAD,EAAf,EAAwB;AAChD,MAAI;AACF,IAAA,GADE;AAEA,EAAA,KAFJ;;AAIA,MAAI,CAAC,yBAAE,OAAF,CAAU,GAAV,CAAL,EAAqB;AACnB,WAAO,KAAP;AACD;;AAED,MAAI,KAAK,GAAG,yBAAE,KAAF,CAAQ,GAAG,CAAC,KAAJ,IAAa,EAArB,EAAyB,IAAzB,CAAZ;AACA,EAAA,KAAK,GAAG,yBAAE,OAAF,CAAU,KAAV,IAAmB,SAAnB,GAA+B,KAAvC;;AAEA,EAAA,KAAK,CAAC,GAAN,GAAY,yBAAE,IAAF,CAAO,GAAP,EAAY;AACtB,QADsB;AAEtB,WAFsB;AAGtB,YAHsB;AAItB;AACA,aALsB,CAAZ,CAAZ;;AAOA,EAAA,KAAK,CAAC,GAAN,CAAU,KAAV,GAAkB,KAAlB;;AAEA,MAAI,WAAW,GAAG,GAAG,CAAC,QAAJ,GAAe,WAAf,GAA6B,EAA/C;AACA,MAAI,YAAY,GAAG,GAAG,CAAC,SAAJ,GAAgB,eAAhB,GAAkC,EAArD;AACA,MAAI,GAAG,GAAG,yBAAE,WAAF,CAAc,KAAd,IAAuB,KAAK,CAAC,GAAN,CAAU,OAAjC,GAA2C,yBAAE,IAAF,CAAO,KAAK,CAAC,GAAN,CAAU,KAAjB,EAAwB,IAAxB,CAArD;AACA,EAAA,GAAG,GAAI,GAAE,WAAY,GAAE,YAAa,GAAE,KAAK,CAAC,GAAN,CAAU,IAAK,KAAI,GAAI,EAA7D;AACA,EAAA,KAAK,CAAC,GAAN,GAAY,KAAK,CAAC,GAAN,IAAa,GAAzB;;AAEA,SAAO,KAAP;AACD,CA5BM,C","file":"err.js","sourcesContent":["import _ from 'lodash-firecloud';\n\nexport let serializeErr = async function({entry}) {\n  let {\n    err\n  } = entry;\n\n  if (!_.isError(err)) {\n    return entry;\n  }\n\n  let stack = _.split(err.stack || '', '\\n');\n  stack = _.isEmpty(stack) ? undefined : stack;\n\n  entry.err = _.pick(err, [\n    'name',\n    'message',\n    'uncaught',\n    // custom\n    'inPromise'\n  ]);\n  entry.err.stack = stack;\n\n  let uncaughtMsg = err.uncaught ? 'Uncaught ' : '';\n  let inPromiseMsg = err.inPromise ? '(in promise) ' : '';\n  let msg = _.isUndefined(stack) ? entry.err.message : _.join(entry.err.stack, '\\n');\n  msg = `${uncaughtMsg}${inPromiseMsg}${entry.err.name}: ${msg}`;\n  entry.msg = entry.msg || msg;\n\n  return entry;\n};\n\nexport default serializeErr;\n"]}