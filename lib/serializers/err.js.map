{"version":3,"sources":["../../src/serializers/err.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;sCAEe,WAAe,EAAC,KAAD,EAAf,EAAwB;AACrC,QAAI,EAAC,GAAD,KAAQ,KAAZ;;AAEA,QAAI,CAAC,iBAAE,OAAF,CAAU,GAAV,CAAL,EAAqB;AACnB,aAAO,KAAP;AACD;;AAED,QAAI,KAAJ;AACA,QAAI;AACF,cAAQ,MAAM,uBAAW,SAAX,CAAqB,GAArB,CAAd;AACD,KAFD,CAEE,OAAO,eAAP,EAAwB;AACxB,UAAI;AACF,gBAAQ,MAAM,uBAAW,SAAX,CAAqB,GAArB,EAA0B,EAAC,SAAS,IAAV,EAA1B,CAAd;AACD,OAFD,CAEE,OAAO,gBAAP,EAAyB;AACzB;AACA,gBAAQ,KAAR,CAAc,gBAAd;AACD;AACD;AACA,cAAQ,KAAR,CAAc,eAAd;AACD;;AAED,UAAM,GAAN,GAAY;AACV,YAAM,IAAI,IADA;AAEV,eAAS,IAAI,OAFH;AAGV,WAHU;;AAKV;AACA,gBAAU,IAAI;AANJ,KAAZ;;AASA,QAAI,WAAW,IAAI,QAAJ,GAAe,WAAf,GAA6B,EAA5C;AACA,QAAI,YAAY,IAAI,SAAJ,GAAgB,eAAhB,GAAkC,EAAlD;AACA,UAAM,GAAN,GAAY,MAAM,GAAN,IACT,GAAE,QAAS,GAAE,SAAU,GAAE,IAAI,IAAK,KAAI,IAAI,OAAQ,EADrD;;AAGA,WAAO,KAAP;AACD,G","file":"err.js","sourcesContent":["import _ from 'lodash';\nimport stacktrace from 'stacktrace-js';\n\nexport default async function({entry}) {\n  let {err} = entry;\n\n  if (!_.isError(err)) {\n    return entry;\n  }\n\n  let stack;\n  try {\n    stack = await stacktrace.fromError(err);\n  } catch (stacktraceError) {\n    try {\n      stack = await stacktrace.fromError(err, {offline: true});\n    } catch (stacktraceError2) {\n      // eslint-disable-next-line no-console\n      console.error(stacktraceError2);\n    }\n    // eslint-disable-next-line no-console\n    console.error(stacktraceError);\n  }\n\n  entry.err = {\n    name: err.name,\n    message: err.message,\n    stack,\n\n    // custom\n    uncaught: err.uncaught\n  };\n\n  let uncaught = err.uncaught ? 'Uncaught ' : '';\n  let inPromise = err.inPromise ? '(in promise) ' : '';\n  entry.msg = entry.msg ||\n    `${uncaught}${inPromise}${err.name}: ${err.message}`;\n\n  return entry;\n};\n"]}